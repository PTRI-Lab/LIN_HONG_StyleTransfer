# ğŸ¨ AI é¢¨æ ¼è½‰æ›å·¥å…·

åŸºæ–¼ ComfyUI å’Œ IPAdapter æŠ€è¡“çš„ç¶²é ç‰ˆé¢¨æ ¼è½‰æ›å·¥å…·ï¼Œè®“æ‚¨è¼•é¬†å°‡ä»»ä½•ç…§ç‰‡è½‰æ›æˆè—è¡“ä½œå“é¢¨æ ¼ã€‚

## âœ¨ ç‰¹è‰²åŠŸèƒ½

- ğŸ–¼ï¸ **ç°¡å–®æ˜“ç”¨**ï¼šç›´è¦ºçš„æ‹–æ”¾ä»‹é¢ï¼Œç„¡éœ€è¤‡é›œæ“ä½œ
- ğŸ¯ **é«˜å“è³ªè¼¸å‡º**ï¼šä½¿ç”¨ SDXL æ¨¡å‹å’Œ IPAdapter æŠ€è¡“
- âš™ï¸ **åƒæ•¸å¯èª¿**ï¼šæä¾›å¤šç¨®åƒæ•¸å¾®èª¿ï¼Œæ»¿è¶³ä¸åŒéœ€æ±‚
- ğŸš€ **å³æ™‚é è¦½**ï¼šæ”¯æ´å¤šç¨®è§£æåº¦ï¼Œå¿«é€Ÿé è¦½æ•ˆæœ
- ğŸ’¾ **ä¸€éµä¸‹è¼‰**ï¼šè¼•é¬†ä¿å­˜è½‰æ›å¾Œçš„åœ–ç‰‡

## ğŸ“‹ ç³»çµ±éœ€æ±‚

### å¾Œç«¯ (ComfyUI)
- Python 3.10+
- NVIDIA GPU (å»ºè­° 8GB VRAM ä»¥ä¸Š)
- ComfyUI
- å¿…è¦çš„æ¨¡å‹æª”æ¡ˆï¼š
  - `dreamshaperXL_lightningDPMSDE.safetensors`
  - IPAdapter æ¨¡å‹
  - ControlNet æ¨¡å‹ (Canny, Depth)

### å‰ç«¯
- ç¾ä»£ç€è¦½å™¨ (Chrome, Firefox, Safari, Edge)
- ç„¡éœ€é¡å¤–å®‰è£

## ğŸš€ å¿«é€Ÿé–‹å§‹

### 1. å®‰è£ ComfyUI

```bash
# å…‹éš† ComfyUI å„²å­˜åº«
git clone https://github.com/comfyanonymous/ComfyUI.git
cd ComfyUI

# å®‰è£ä¾è³´
pip install -r requirements.txt

# ä¸‹è¼‰å¿…è¦çš„æ¨¡å‹æª”æ¡ˆ
# å°‡æ¨¡å‹æ”¾ç½®åœ¨ ComfyUI/models/ å°æ‡‰çš„è³‡æ–™å¤¾ä¸­
```

### 2. å®‰è£å¿…è¦çš„ Custom Nodes

```bash
cd ComfyUI/custom_nodes

# IPAdapter
git clone https://github.com/cubiq/ComfyUI_IPAdapter_plus.git

# ControlNet Preprocessors
git clone https://github.com/Fannovel16/comfyui_controlnet_aux.git

# å…¶ä»–å¿…è¦ç¯€é»
git clone https://github.com/pythongosssss/ComfyUI-Custom-Scripts.git
```

### 3. ä¸‹è¼‰æ¨¡å‹æª”æ¡ˆ

#### Checkpoint æ¨¡å‹
- ä¸‹è¼‰ [DreamShaper XL Lightning](https://civitai.com/models/112902/dreamshaper-xl)
- æ”¾ç½®æ–¼ `ComfyUI/models/checkpoints/`

#### IPAdapter æ¨¡å‹
- ä¸‹è¼‰ IPAdapter SDXL æ¨¡å‹
- æ”¾ç½®æ–¼ `ComfyUI/models/ipadapter/`

#### ControlNet æ¨¡å‹
- ä¸‹è¼‰ [SDXL Canny ControlNet](https://huggingface.co/xinsir/controlnet-canny-sdxl-1.0)
- ä¸‹è¼‰ [SDXL Depth ControlNet](https://huggingface.co/diffusers/controlnet-depth-sdxl-1.0)
- æ”¾ç½®æ–¼ `ComfyUI/models/controlnet/`

### 4. å•Ÿå‹• ComfyUI

```bash
# å•Ÿå‹• ComfyUI ä¸¦å•Ÿç”¨ CORS
python main.py --listen --cors-allow-origins

# å¦‚æœä½¿ç”¨ Cloudflare Tunnel
cloudflared tunnel --url http://localhost:8188
```

### 5. ä½¿ç”¨å‰ç«¯ä»‹é¢

1. ä¸‹è¼‰ `style_transfer_ui.html`
2. åœ¨ç€è¦½å™¨ä¸­é–‹å•Ÿæª”æ¡ˆ
3. è¼¸å…¥ ComfyUI ä¼ºæœå™¨åœ°å€ (ä¾‹å¦‚ï¼š`http://127.0.0.1:8188`)
4. é–‹å§‹ä½¿ç”¨ï¼

## ğŸ“– ä½¿ç”¨èªªæ˜

### åŸºæœ¬æ“ä½œ

1. **è¼¸å…¥ API åœ°å€**
   - æœ¬åœ°é–‹ç™¼ï¼š`http://127.0.0.1:8188`
   - é ç«¯ä¼ºæœå™¨ï¼šè¼¸å…¥ä½ çš„ä¼ºæœå™¨ URL

2. **ä¸Šå‚³åœ–ç‰‡**
   - **å…§å®¹åœ–ç‰‡**ï¼šè¦è¢«è½‰æ›çš„ç…§ç‰‡
   - **é¢¨æ ¼åœ–ç‰‡**ï¼šæä¾›è—è¡“é¢¨æ ¼çš„åƒè€ƒåœ–

3. **èª¿æ•´åƒæ•¸** (å¯é¸)
   - ğŸ¨ **é¢¨æ ¼åŒ–ç¨‹åº¦**ï¼šæ§åˆ¶é¢¨æ ¼å¼·åº¦ (0.5-2.0)
   - ğŸ“ **ä¿ç•™æ§‹åœ–**ï¼šæ§åˆ¶ä¿ç•™åŸåœ–æ§‹åœ–çš„ç¨‹åº¦ (0.5-1.5)
   - âœï¸ **ä¿ç•™è¼ªå»“**ï¼šæ§åˆ¶ä¿ç•™ç‰©é«”å½¢ç‹€ (0-1.0)
   - ğŸ”ï¸ **ä¿ç•™ç«‹é«”æ„Ÿ**ï¼šæ§åˆ¶ä¿ç•™ç©ºé–“æ·±åº¦ (0-1.0)
   - âš¡ **ç”Ÿæˆå“è³ª**ï¼šæ¡æ¨£æ­¥æ•¸ï¼Œè¶Šé«˜è¶Šç´°ç·» (4-15)
   - ğŸ“ **è¼¸å‡ºå°ºå¯¸**ï¼š512px / 768px / 1024px / 1536px

4. **é–‹å§‹è½‰æ›**
   - é»æ“Šã€Œé–‹å§‹è½‰æ›é¢¨æ ¼ã€æŒ‰éˆ•
   - ç­‰å¾…è™•ç†å®Œæˆ (ç´„ 30-120 ç§’)

5. **ä¸‹è¼‰çµæœ**
   - é»æ“Šã€Œä¸‹è¼‰åœ–ç‰‡ã€ä¿å­˜ä½œå“

### åƒæ•¸å»ºè­°

#### å¿«é€Ÿé è¦½è¨­å®š
```
ç”Ÿæˆå“è³ª: 6
è¼¸å‡ºå°ºå¯¸: 512px æˆ– 768px
æ”¾å¤§å€æ•¸: 1.0
è™•ç†æ™‚é–“: ~30ç§’
```

#### é«˜å“è³ªè¼¸å‡º
```
ç”Ÿæˆå“è³ª: 12
è¼¸å‡ºå°ºå¯¸: 1024px æˆ– 1536px
æ”¾å¤§å€æ•¸: 1.5
è™•ç†æ™‚é–“: ~90ç§’
```

#### å¼·çƒˆé¢¨æ ¼åŒ–
```
é¢¨æ ¼åŒ–ç¨‹åº¦: 1.8-2.0
ä¿ç•™æ§‹åœ–: 0.5-0.6
ä¿ç•™è¼ªå»“: 0.6-0.7
ä¿ç•™ç«‹é«”æ„Ÿ: 0.6-0.7
```

#### ä¿ç•™åŸåœ–ç‰¹å¾µ
```
é¢¨æ ¼åŒ–ç¨‹åº¦: 0.8-1.0
ä¿ç•™æ§‹åœ–: 1.2-1.5
ä¿ç•™è¼ªå»“: 0.9-1.0
ä¿ç•™ç«‹é«”æ„Ÿ: 0.9-1.0
```

## ğŸ”§ æŠ€è¡“æ¶æ§‹

### å·¥ä½œæµç¨‹

```
åŸåœ– â†’ ControlNet (LineArt + Depth) â†’ IPAdapter (Style) â†’ KSampler â†’ çµæœ
```

### æ ¸å¿ƒæŠ€è¡“

- **IPAdapter**ï¼šç”¨æ–¼é¢¨æ ¼é·ç§»ï¼Œå°‡é¢¨æ ¼åœ–çš„è¦–è¦ºç‰¹å¾µæ‡‰ç”¨åˆ°å…§å®¹åœ–
- **ControlNet**ï¼š
  - LineArtï¼šä¿æŒåŸåœ–çš„ç·šæ¢å’Œè¼ªå»“
  - Depthï¼šä¿æŒåŸåœ–çš„ç©ºé–“æ·±åº¦é—œä¿‚
- **SDXL Lightning**ï¼šå¿«é€Ÿç”Ÿæˆé«˜å“è³ªåœ–åƒ
- **Two-Stage Generation**ï¼šåŸºç¤ç”Ÿæˆ + é«˜è§£æåº¦ç´°åŒ–

## ğŸ› å¸¸è¦‹å•é¡Œ

### Q: å‡ºç¾ CORS éŒ¯èª¤
**A:** ç¢ºä¿ ComfyUI å•Ÿå‹•æ™‚åŠ ä¸Š `--cors-allow-origins=*` åƒæ•¸

### Q: è™•ç†æ™‚é–“éé•·
**A:** 
- é™ä½ã€Œç”Ÿæˆå“è³ªã€(Steps)
- é¸æ“‡è¼ƒå°çš„ã€Œè¼¸å‡ºå°ºå¯¸ã€
- é™ä½ã€Œæ”¾å¤§å€æ•¸ã€

### Q: é¢¨æ ¼æ•ˆæœä¸æ˜é¡¯
**A:** 
- æé«˜ã€Œé¢¨æ ¼åŒ–ç¨‹åº¦ã€
- é™ä½ã€Œä¿ç•™æ§‹åœ–ã€ã€Œä¿ç•™è¼ªå»“ã€ã€Œä¿ç•™ç«‹é«”æ„Ÿã€

### Q: çµæœèˆ‡åŸåœ–å·®ç•°å¤ªå¤§
**A:** 
- é™ä½ã€Œé¢¨æ ¼åŒ–ç¨‹åº¦ã€
- æé«˜ã€Œä¿ç•™æ§‹åœ–ã€ã€Œä¿ç•™è¼ªå»“ã€ã€Œä¿ç•™ç«‹é«”æ„Ÿã€

### Q: æ¨¡å‹è¼‰å…¥å¤±æ•—
**A:** ç¢ºèªä»¥ä¸‹æª”æ¡ˆæ˜¯å¦æ­£ç¢ºæ”¾ç½®ï¼š
```
ComfyUI/models/
â”œâ”€â”€ checkpoints/
â”‚   â””â”€â”€ dreamshaperXL_lightningDPMSDE.safetensors
â”œâ”€â”€ ipadapter/
â”‚   â””â”€â”€ (IPAdapter ç›¸é—œæ¨¡å‹)
â””â”€â”€ controlnet/
    â”œâ”€â”€ sd_xl_base_control-lora-canny-rank256.safetensors
    â””â”€â”€ sai_xl_depth_256lora.safetensors
```

## ğŸ“ å°ˆæ¡ˆçµæ§‹

```
.
â”œâ”€â”€ style_transfer_ui.html    # å‰ç«¯ä»‹é¢
â”œâ”€â”€ README.md                  # èªªæ˜æ–‡ä»¶
â””â”€â”€ examples/                  # ç¯„ä¾‹åœ–ç‰‡
    â”œâ”€â”€ content/              # å…§å®¹åœ–ç‰‡ç¯„ä¾‹
    â””â”€â”€ style/                # é¢¨æ ¼åœ–ç‰‡ç¯„ä¾‹
```

5. é–‹å•Ÿ Pull Request


## åƒè€ƒè³‡æº

- [ComfyUI](https://github.com/comfyanonymous/ComfyUI) - å¼·å¤§çš„ Stable Diffusion GUI
- [IPAdapter](https://github.com/tencent-ailab/IP-Adapter) - åœ–åƒæç¤ºé©é…å™¨
- [ControlNet](https://github.com/lllyasviel/ControlNet) - ç²¾ç¢ºæ§åˆ¶åœ–åƒç”Ÿæˆ


**æ³¨æ„**ï¼šæœ¬å·¥å…·åƒ…ä¾›å­¸ç¿’å’Œç ”ç©¶ä½¿ç”¨ï¼Œè«‹å‹¿ç”¨æ–¼å•†æ¥­ç”¨é€”æˆ–ä¾µçŠ¯ä»–äººç‰ˆæ¬Šçš„è¡Œç‚ºã€‚
